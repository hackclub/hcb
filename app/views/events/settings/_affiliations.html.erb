<%# locals: (event:) %>

<% disabled = !policy(event).update? %>

<%= turbo_frame_tag :affiliations_settings do %>
  <h3 class="mb1" id="affiliations_heading">Add a new affiliation</h3>
  <div class="card mb3">
    <%= form_with(url: event_affiliations_path(event), local: true, html: { "x-data": "{ type: 'first' }" }) do |form| %>
      <div class="field">
        <%# not applying a disabled here so they can know what the different affilations are like %>
        <%= form.label :type, "Type" %>
        <%= form.select :type, [["FIRST", "first"], ["VEX", "vex"], ["Hack Club", "hack_club"]], { required: true, include_blank: "Select a type", selected: "first" }, { "@change": "type = $event.target.value" } %>
      </div>

      <template x-if="type == 'first'">
        <div class="field">
          <%= form.label :league, "League" %>
          <%= form.select :league, [["FRC", "frc"], ["FTC", "ftc"], ["FLL", "fll"]], { required: true, include_blank: "Select a league" }, disabled: %>
        </div>
      </template>
      <template x-if="type == 'first'">
        <div class="field">
          <%= form.label :team_number, "Team number" %>
          <%= form.text_field :team_number, { required: true, placeholder: "9101", disabled: } %>
        </div>
      </template>
      <template x-if="type == 'first'">
        <div class="field">
          <%= form.label :size, "Size" %>
          <%= form.number_field :size, { required: true, placeholder: 0, disabled: } %>
        </div>
      </template>

      <template x-if="type == 'vex'">
        <div class="field">
          <%= form.label :league, "League" %>
          <%= form.select :league, [["123", "123"], ["GO", "go"], ["AIM", "aim"], ["IQ", "iq"], ["EXP", "exp"], ["V5", "v5"], ["CTE", "cte"], ["AIR", "air"]], { required: true, include_blank: "Select a league" }, disabled: %>
        </div>
      </template>
      <template x-if="type == 'vex'">
        <div class="field">
          <%= form.label :team_number, "Team number" %>
          <%= form.text_field :team_number, { required: true, placeholder: "11981B", disabled: } %>
        </div>
      </template>
      <template x-if="type == 'vex'">
        <div class="field">
          <%= form.label :size, "Size" %>
          <%= form.number_field :size, { required: true, placeholder: 0, disabled: } %>
        </div>
      </template>

      <template x-if="type == 'hack_club'">
        <div class="field">
          <%= form.label :venue_name, "Venue name" %>
          <%= form.text_field :venue_name, { required: true, placeholder: "Pierson Library", disabled: } %>
        </div>
      </template>
      <template x-if="type == 'hack_club'">
        <div class="field">
          <%= form.label :size, "Size" %>
          <%= form.number_field :size, { required: true, placeholder: 0, disabled: } %>
        </div>
      </template>

      <template x-if="type == ''">
        <p>Please select an affiliation type.</p>
      </template>

      <%= form.submit "Add affiliation", disabled: %>
    <% end %>
  </div>
<% end %>
