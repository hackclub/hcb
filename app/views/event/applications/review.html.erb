<% title "Review Application" %>

<div class="flex flex-col md:flex-row gap-4 h-full">
  <div class="flex flex-col flex-grow justify-between md:max-w-[50%]">
    <div class="flex flex-col">
      <h2 class="text-4xl">
        Review your application
      </h2>

      <p class="mt-0 text-lg muted">Make sure everything looks correct before submitting</p>
    </div>

    <div class="max-w-lg card flex flex-col gap-3 card--sunken mb-7">
      <div class="flex flex-row items-center justify-start gap-2">
        <%= inline_icon "help", size: 28 %>
        <h3 class="text-lg my-0">Need help?</h3>
      </div>
      <p class="my-0"><%= link_to "Live chat support", "#" %> is currently available.</p>
      <p class="my-0">Additionally, you can email questions to <%= link_to "hcb@hackclub.com", "mailto:hcb@hackclub.com" %> or give us a call at <%= link_to "+1 (844) 237-2290", "tel:+18442372290", class: "text-nowrap" %>.</p>
    </div>
  </div>

  <div class="flex flex-col flex-grow md:max-w-[50%] basis-0">
    <div class="mt-7 space-y-8">
      <!-- Project Information Section -->
      <div>
        <div class="flex items-center justify-between gap-4 mb-4">
          <h3 class="text-2xl my-0">Project Information</h3>
          <%= link_to application_project_info_path(@application), class: "text-sm text-blue-500 hover:underline flex items-center gap-1" do %>
            <%= inline_icon "edit", size: 16 %>
            Edit
          <% end %>
        </div>
        <div class="card card--breakdown p-4 space-y-4">
          <div>
            <p class="text-sm muted mb-1 mt-0">Project name</p>
            <p class="mb-0 font-medium"><%= @application.name %></p>
          </div>
          <div>
            <p class="text-sm muted mb-1">Project description</p>
            <p class="mb-0 whitespace-pre-wrap"><%= @application.description %></p>
          </div>
          <div>
            <p class="text-sm muted mb-1">Political activity involvement</p>
            <p class="mb-0"><%= @application.political ? "Yes" : "No" %></p>
          </div>
        </div>
      </div>

      <!-- Personal Information Section -->
      <div>
        <div class="flex items-center justify-between gap-4 mb-4">
          <h3 class="text-2xl my-0">Personal Information</h3>
          <%= link_to application_personal_info_path(@application), class: "text-sm text-blue-500 hover:underline flex items-center gap-1" do %>
            <%= inline_icon "edit", size: 16 %>
            Edit
          <% end %>
        </div>
        <div class="card card--breakdown p-4 space-y-4 mb-6">
          <div class="grid grid-cols-3 gap-4">
            <div>
              <p class="text-sm muted mb-1 mt-0">Street address</p>
              <p class="mb-0"><%= @application.address_line1 %></p>
            </div>
            <div>
              <p class="mb-0"><%= @application.address_line2 %></p>
            </div>
            <div>
              <p class="text-sm muted mb-1 mt-0">City</p>
              <p class="mb-0"><%= @application.address_city %></p>
            </div>
          </div>

          <div class="grid grid-cols-3 gap-4">
            <div>
              <p class="text-sm muted mb-1">State</p>
              <p class="mb-0"><%= @application.address_state %></p>
            </div>
            <div>
              <p class="text-sm muted mb-1">Zip code</p>
              <p class="mb-0"><%= @application.address_postal_code %></p>
            </div>
            <div>
              <p class="text-sm muted mb-1">Country</p>
              <p class="mb-0"><%= @application.address_country %></p>
            </div>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <p class="text-sm muted mb-1">How did you hear about HCB?</p>
              <p class="mb-0"><%= @application.referrer %></p>
            </div>
            <div>
              <p class="text-sm muted mb-1">Referral code</p>
              <p class="mb-0"><%= @application.referral_code.presence || "—" %></p>
            </div>
          </div>

          <% if @application.notes.present? %>
            <div>
              <p class="text-sm muted mb-1">Accessibility needs</p>
              <p class="mb-0 whitespace-pre-wrap"><%= @application.notes %></p>
            </div>
          <% end %>

          <% if @application.user.teenager? && @application.cosigner_email.present? %>
            <div>
              <p class="text-sm muted mb-1">Parent email</p>
              <p class="mb-0"><%= @application.cosigner_email %></p>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<% content_for :footer do %>
  <div class="flex flex-row gap-6 items-start justify-center">
    <%= link_to "← Back", application_personal_info_path(@application), class: "btn bg-muted" %>
    <%= link_to application_path(@application), class: "btn bg-slate hidden" do %>
      <%= inline_icon "message", size: 28 %>
      Live chat support
    <% end %>
  </div>
  <%= form_with model: @application, url: application_path(@application), method: :patch, id: "edit_application_#{@application.id}" do |form| %>
    <%= form.hidden_field :return_to, value: application_review_path(@application) %>
  <% end %>
  <button class="btn" form="edit_application_<%= @application.id %>">Submit Application</button>
<% end %>
