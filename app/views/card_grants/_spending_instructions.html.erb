<%# locals: (card_grant:) %>

<% if card_grant.active? && (stripe_card = card_grant.stripe_card).present? %>
  <div>
    <div class="card container--md">
      <h3 class="mt0 mb0 info bold">How do I make purchases on this card?</h3>
      <p class="mt1">Here's all the info you might need:</p>

      <section class="details">
        <p class="fs-mask">
          <strong>
            Card number
          </strong>
          <% if card_grant.user == current_user %>
            <%= stripe_card.formatted_card_number %>
          <% else %>
            <%= stripe_card.hidden_card_number %>
          <% end %>
        </p>

        <p class="fs-mask">
          <strong>CVC</strong>
          <% if card_grant.user == current_user %>
            <%= stripe_card.cvc %>
          <% else %>
            <%= stripe_card.hidden_cvc %>
          <% end %>
        </p>

        <p class="fs-mask">
          <strong>Expiration date</strong>
          <%= render_exp_date stripe_card %>
        </p>

        <p>
          <strong>ZIP/Postal code</strong>
          <%= stripe_card.stripe_cardholder.address_postal_code %>
        </p>
        <p>
          <strong>Billing address</strong>
          <%= render_address stripe_card.cardholder %>
        </p>
      </section>
      <section class="card__banner card__banner--bottom card__darker pt2 pb2">
        <p class="muted mt0 mb0">
          The card will be available for use until <%= format_date card_grant.expires_on %>. Afterward, the remaining funds will be returned to <%= card_grant.event.name %>.
        </p>
      </section>
    </div>
  </div>
<% end %>
